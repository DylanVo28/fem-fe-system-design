<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Demo: T√≠nh to√°n th·ªß c√¥ng v·ªã tr√≠ ph·∫ßn t·ª≠ (tr∆∞·ªõc Intersection Observer)</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 200vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            margin-bottom: 30px;
            text-align: center;
        }

        .header h1 {
            color: #333;
            margin-bottom: 15px;
            font-size: 2.5em;
        }

        .header p {
            color: #666;
            font-size: 1.2em;
        }

        .demo-section {
            background: rgba(255, 255, 255, 0.9);
            margin: 50px 0;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            transition: all 0.3s ease;
        }

        .demo-section.visible {
            background: rgba(76, 175, 80, 0.1);
            border: 3px solid #4CAF50;
            transform: scale(1.02);
        }

        .demo-section h2 {
            color: #333;
            margin-bottom: 20px;
            font-size: 2em;
        }

        .demo-section p {
            color: #666;
            margin-bottom: 15px;
            font-size: 1.1em;
        }

        .status-indicator {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 15px 20px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            z-index: 1000;
            min-width: 200px;
        }

        .status-indicator h3 {
            margin-bottom: 10px;
            color: #4CAF50;
        }

        .status-item {
            margin: 5px 0;
            padding: 5px 0;
            border-bottom: 1px solid #333;
        }

        .status-item:last-child {
            border-bottom: none;
        }

        .visible-text {
            color: #4CAF50;
            font-weight: bold;
        }

        .hidden-text {
            color: #f44336;
            font-weight: bold;
        }

        .code-block {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            overflow-x: auto;
        }

        .highlight {
            background: #fff3cd;
            padding: 2px 4px;
            border-radius: 3px;
        }

        .scroll-info {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 15px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
        }

        .spacer {
            height: 100vh;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 2em;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="status-indicator">
        <h3>üìä Tr·∫°ng th√°i ph·∫ßn t·ª≠</h3>
        <div id="status-list"></div>
    </div>

    <div class="scroll-info">
        <div>Scroll Y: <span id="scroll-y">0</span>px</div>
        <div>Window Height: <span id="window-height">0</span>px</div>
    </div>

    <div class="container">
        <div class="header">
            <h1>üîç Demo: T√≠nh to√°n th·ªß c√¥ng v·ªã tr√≠ ph·∫ßn t·ª≠</h1>
            <p>Tr∆∞·ªõc khi c√≥ Intersection Observer API, l·∫≠p tr√¨nh vi√™n ph·∫£i t·ª± t√≠nh to√°n b·∫±ng c√°ch s·ª≠ d·ª•ng scroll event v√† getBoundingClientRect()</p>
        </div>

        <div class="spacer">
            <div>Cu·ªôn xu·ªëng ƒë·ªÉ xem demo...</div>
        </div>

        <div class="demo-section" data-section="1">
            <h2>üìù Ph·∫ßn 1: Gi·ªõi thi·ªáu</h2>
            <p>ƒê√¢y l√† ph·∫ßn ƒë·∫ßu ti√™n. H√£y cu·ªôn ƒë·ªÉ xem c√°ch t√≠nh to√°n v·ªã tr√≠ ho·∫°t ƒë·ªông.</p>
            <div class="code-block">
// C√°ch t√≠nh to√°n th·ªß c√¥ng tr∆∞·ªõc ƒë√¢y:
window.addEventListener('scroll', function() {
    const element = document.querySelector('.demo-section');
    const rect = element.getBoundingClientRect();
    
    // Ki·ªÉm tra xem ph·∫ßn t·ª≠ c√≥ trong viewport kh√¥ng
    const isVisible = rect.top < window.innerHeight && rect.bottom > 0;
    
    if (isVisible) {
        console.log('Ph·∫ßn t·ª≠ ƒëang hi·ªÉn th·ªã!');
    }
});
            </div>
        </div>

        <div class="demo-section" data-section="2">
            <h2>‚öôÔ∏è Ph·∫ßn 2: C√°ch ho·∫°t ƒë·ªông</h2>
            <p>getBoundingClientRect() tr·∫£ v·ªÅ v·ªã tr√≠ c·ªßa ph·∫ßn t·ª≠ so v·ªõi viewport.</p>
            <div class="code-block">
const rect = element.getBoundingClientRect();
console.log({
    top: rect.top,        // Kho·∫£ng c√°ch t·ª´ ƒë·ªânh viewport
    bottom: rect.bottom,  // Kho·∫£ng c√°ch t·ª´ ƒë√°y viewport  
    left: rect.left,      // Kho·∫£ng c√°ch t·ª´ b√™n tr√°i viewport
    right: rect.right     // Kho·∫£ng c√°ch t·ª´ b√™n ph·∫£i viewport
});
            </div>
        </div>

        <div class="demo-section" data-section="3">
            <h2>üéØ Ph·∫ßn 3: Logic ki·ªÉm tra</h2>
            <p>ƒê·ªÉ ki·ªÉm tra ph·∫ßn t·ª≠ c√≥ trong viewport, ta so s√°nh:</p>
            <div class="code-block">
// Ph·∫ßn t·ª≠ hi·ªÉn th·ªã khi:
// - ƒê·ªânh ph·∫ßn t·ª≠ < chi·ªÅu cao c·ª≠a s·ªï (ch∆∞a cu·ªôn h·∫øt)
// - ƒê√°y ph·∫ßn t·ª≠ > 0 (ch∆∞a cu·ªôn qua h·∫øt)

const isVisible = rect.top < window.innerHeight && rect.bottom > 0;
            </div>
        </div>

        <div class="demo-section" data-section="4">
            <h2>üöÄ Ph·∫ßn 4: V·∫•n ƒë·ªÅ hi·ªáu su·∫•t</h2>
            <p>Scroll event ƒë∆∞·ª£c g·ªçi r·∫•t nhi·ªÅu l·∫ßn, g√¢y ·∫£nh h∆∞·ªüng hi·ªáu su·∫•t.</p>
            <div class="code-block">
// V·∫•n ƒë·ªÅ: Scroll event ƒë∆∞·ª£c g·ªçi li√™n t·ª•c
window.addEventListener('scroll', function() {
    // Code n√†y ch·∫°y h√†ng trƒÉm l·∫ßn m·ªói gi√¢y!
    // C·∫ßn throttle ho·∫∑c debounce ƒë·ªÉ t·ªëi ∆∞u
});
            </div>
        </div>

        <div class="demo-section" data-section="5">
            <h2>‚ú® Ph·∫ßn 5: Gi·∫£i ph√°p hi·ªán ƒë·∫°i</h2>
            <p>Intersection Observer API gi·∫£i quy·∫øt t·∫•t c·∫£ v·∫•n ƒë·ªÅ n√†y!</p>
            <div class="code-block">
// Gi·∫£i ph√°p hi·ªán ƒë·∫°i v·ªõi Intersection Observer
const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
        if (entry.isIntersecting) {
            console.log('Ph·∫ßn t·ª≠ ƒëang hi·ªÉn th·ªã!');
        }
    });
});

observer.observe(element);
            </div>
        </div>

        <div class="spacer">
            <div>üéâ K·∫øt th√∫c demo!</div>
        </div>
    </div>

    <script>
        // Danh s√°ch c√°c ph·∫ßn t·ª≠ c·∫ßn theo d√µi
        const sections = document.querySelectorAll('.demo-section');
        const statusList = document.getElementById('status-list');
        const scrollYElement = document.getElementById('scroll-y');
        const windowHeightElement = document.getElementById('window-height');

        // C·∫≠p nh·∫≠t th√¥ng tin scroll
        function updateScrollInfo() {
            scrollYElement.textContent = Math.round(window.scrollY);
            windowHeightElement.textContent = window.innerHeight;
        }

        // H√†m ki·ªÉm tra ph·∫ßn t·ª≠ c√≥ trong viewport kh√¥ng (c√°ch th·ªß c√¥ng)
        function isElementInViewport(element) {
            const rect = element.getBoundingClientRect();
            return rect.top < window.innerHeight && rect.bottom > 0;
        }

        // H√†m c·∫≠p nh·∫≠t tr·∫°ng th√°i hi·ªÉn th·ªã
        function updateVisibilityStatus() {
            let statusHTML = '';
            
            sections.forEach((section, index) => {
                const isVisible = isElementInViewport(section);
                const sectionNumber = section.dataset.section;
      
                if (isVisible) {
                    section.classList.add('visible');
                } else {
                    section.classList.remove('visible');
                }
                
                statusHTML += `
                    <div class="status-item">
                        Ph·∫ßn ${sectionNumber}: 
                        <span class="${isVisible ? 'visible-text' : 'hidden-text'}">
                            ${isVisible ? 'Hi·ªÉn th·ªã' : '·∫®n'}
                        </span>
                    </div>
                `;
            });
            
            statusList.innerHTML = statusHTML;
        }

        // Throttle function ƒë·ªÉ t·ªëi ∆∞u hi·ªáu su·∫•t
        function throttle(func, limit) {
            let inThrottle;
            return function() {
                const args = arguments;
                const context = this;
                if (!inThrottle) {
                    func.apply(context, args);
                    inThrottle = true;
                    setTimeout(() => inThrottle = false, limit);
                }
            }
        }

        // G·∫Øn s·ª± ki·ªán scroll v·ªõi throttle (100ms)
        window.addEventListener('scroll', throttle(function() {
            updateScrollInfo();
            updateVisibilityStatus();
        }, 100));

        // G·∫Øn s·ª± ki·ªán resize
        window.addEventListener('resize', throttle(function() {
            updateScrollInfo();
            updateVisibilityStatus();
        }, 100));

        // Kh·ªüi t·∫°o
        updateScrollInfo();
        updateVisibilityStatus();

        // Log th√¥ng tin chi ti·∫øt khi scroll
        window.addEventListener('scroll', throttle(function() {
            console.log('=== Th√¥ng tin scroll ===');
            console.log('Scroll Y:', window.scrollY);
            console.log('Window Height:', window.innerHeight);
            
            sections.forEach((section, index) => {
                const rect = section.getBoundingClientRect();
                const isVisible = isElementInViewport(section);
                
                console.log(`Ph·∫ßn ${section.dataset.section}:`, {
                    top: Math.round(rect.top),
                    bottom: Math.round(rect.bottom),
                    visible: isVisible
                });
            });
        }, 200));
    </script>
</body>
</html>
