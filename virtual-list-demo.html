<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Virtual List Demo - T·ªëi ∆∞u hi·ªáu su·∫•t danh s√°ch d√†i</title>
    <link rel="stylesheet" href="virtual-list-styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>üöÄ Virtual List Demo</h1>
            <p>T·ªëi ∆∞u hi·ªáu su·∫•t khi hi·ªÉn th·ªã danh s√°ch 10,000 items</p>
        </header>

        <div class="controls">
            <button id="normalList" class="btn">Hi·ªÉn th·ªã danh s√°ch th∆∞·ªùng (ch·∫≠m)</button>
            <button id="virtualList" class="btn primary">Hi·ªÉn th·ªã Virtual List (nhanh)</button>
            <button id="clearList" class="btn secondary">X√≥a danh s√°ch</button>
        </div>

        <div class="info">
            <div class="info-item">
                <span class="label">T·ªïng s·ªë items:</span>
                <span id="totalItems">0</span>
            </div>
            <div class="info-item">
                <span class="label">Items ƒëang render:</span>
                <span id="renderedItems">0</span>
            </div>
            <div class="info-item">
                <span class="label">Th·ªùi gian render:</span>
                <span id="renderTime">0ms</span>
            </div>
        </div>

        <!-- Container cho danh s√°ch th∆∞·ªùng -->
        <div id="normalListContainer" class="list-container" style="display: none;">
            <h3>üìã Danh s√°ch th∆∞·ªùng (t·∫•t c·∫£ items trong DOM)</h3>
            <div id="normalListItems"></div>
        </div>

        <!-- Container cho Virtual List -->
        <div id="virtualListContainer" class="list-container" style="display: none;">
            <h3>‚ö° Virtual List (ch·ªâ render items nh√¨n th·∫•y)</h3>
            <div id="virtualListRoot" class="virtual-list-root">
                <!-- Virtual List s·∫Ω ƒë∆∞·ª£c render ·ªü ƒë√¢y -->
            </div>
        </div>

        <div class="explanation">
            <h3>üí° C√°ch ho·∫°t ƒë·ªông c·ªßa Virtual List</h3>
            <div class="explanation-content">
                <div class="step">
                    <div class="step-number">1</div>
                    <div class="step-content">
                        <strong>Render ban ƒë·∫ßu:</strong> Ch·ªâ hi·ªÉn th·ªã c√°c items trong viewport (kho·∫£ng 10-15 items)
                    </div>
                </div>
                <div class="step">
                    <div class="step-number">2</div>
                    <div class="step-content">
                        <strong>Cu·ªôn xu·ªëng:</strong> Khi ch·∫°m bottom observer, t·∫£i th√™m items m·ªõi
                    </div>
                </div>
                <div class="step">
                    <div class="step-number">3</div>
                    <div class="step-content">
                        <strong>T√°i s·ª≠ d·ª•ng DOM:</strong> Items c≈© ƒë∆∞·ª£c t√°i s·ª≠ d·ª•ng cho items m·ªõi (recycling)
                    </div>
                </div>
                <div class="step">
                    <div class="step-number">4</div>
                    <div class="step-content">
                        <strong>Di chuy·ªÉn v·ªã tr√≠:</strong> S·ª≠ d·ª•ng CSS transform ƒë·ªÉ di chuy·ªÉn items
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="virtual-list.js"></script>
    <script>
        // Demo script
        const TOTAL_ITEMS = 10000;
        let virtualList = null;

        // T·∫°o d·ªØ li·ªáu m·∫´u
        function generateData(count) {
            return Array.from({ length: count }, (_, i) => ({
                id: i + 1,
                title: `Item ${i + 1}`,
                description: `M√¥ t·∫£ cho item ${i + 1}`,
                color: `hsl(${(i * 137.5) % 360}, 70%, 60%)`
            }));
        }

        // Hi·ªÉn th·ªã danh s√°ch th∆∞·ªùng
        function showNormalList() {
            const startTime = performance.now();
            
            document.getElementById('normalListContainer').style.display = 'block';
            document.getElementById('virtualListContainer').style.display = 'none';
            
            const container = document.getElementById('normalListItems');
            container.innerHTML = '';
            
            const data = generateData(TOTAL_ITEMS);
            
            data.forEach(item => {
                const div = document.createElement('div');
                div.className = 'list-item normal';
                div.style.backgroundColor = item.color;
                div.innerHTML = `
                    <div class="item-id">#${item.id}</div>
                    <div class="item-title">${item.title}</div>
                    <div class="item-description">${item.description}</div>
                `;
                container.appendChild(div);
            });
            
            const endTime = performance.now();
            updateInfo(TOTAL_ITEMS, TOTAL_ITEMS, endTime - startTime);
        }

        // Hi·ªÉn th·ªã Virtual List
        function showVirtualList() {
            const startTime = performance.now();
            
            document.getElementById('normalListContainer').style.display = 'none';
            document.getElementById('virtualListContainer').style.display = 'block';
            
            const data = generateData(TOTAL_ITEMS);
            const root = document.getElementById('virtualListRoot');
            
            // T·∫°o Virtual List
            virtualList = new VirtualList({
                root,
                data,
                itemHeight: 80,
                visibleCount: 15,
                renderItem: (item, index) => `
                    <div class="list-item virtual" style="background-color: ${item.color}">
                        <div class="item-id">#${item.id}</div>
                        <div class="item-title">${item.title}</div>
                        <div class="item-description">${item.description}</div>
                    </div>
                `
            });
            
            const endTime = performance.now();
            updateInfo(TOTAL_ITEMS, virtualList.visibleCount, endTime - startTime);
        }

        // X√≥a danh s√°ch
        function clearList() {
            document.getElementById('normalListContainer').style.display = 'none';
            document.getElementById('virtualListContainer').style.display = 'none';
            document.getElementById('normalListItems').innerHTML = '';
            document.getElementById('virtualListRoot').innerHTML = '';
            virtualList = null;
            updateInfo(0, 0, 0);
        }

        // C·∫≠p nh·∫≠t th√¥ng tin
        function updateInfo(total, rendered, time) {
            document.getElementById('totalItems').textContent = total.toLocaleString();
            document.getElementById('renderedItems').textContent = rendered.toLocaleString();
            document.getElementById('renderTime').textContent = `${time.toFixed(2)}ms`;
        }

        // Event listeners
        document.getElementById('normalList').addEventListener('click', showNormalList);
        document.getElementById('virtualList').addEventListener('click', showVirtualList);
        document.getElementById('clearList').addEventListener('click', clearList);
    </script>
</body>
</html>
