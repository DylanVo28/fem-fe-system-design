<!doctype html>
<html lang="vi">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>DOM API - T√≥m t·∫Øt & Hi·ªáu nƒÉng</title>
    <style>
      :root {
        --bg: #0b0d10;
        --panel: #11151a;
        --text: #e6edf3;
        --muted: #9aa4af;
        --accent: #67e8f9;
        --accent-2: #a78bfa;
        --border: #1f2630;
        --code-bg: #0f1318;
      }
      * { box-sizing: border-box; }
      html, body { height: 100%; }
      body {
        margin: 0;
        background: radial-gradient(1200px 800px at 20% -10%, rgba(103,232,249,0.06), transparent),
                    radial-gradient(1000px 700px at 120% 20%, rgba(167,139,250,0.06), transparent),
                    var(--bg);
        color: var(--text);
        font: 16px/1.6 system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      }
      .container {
        max-width: 960px;
        margin: 0 auto;
        padding: 32px 20px 64px;
      }
      header {
        position: sticky;
        top: 0;
        background: linear-gradient(180deg, rgba(11,13,16,0.9), rgba(11,13,16,0.65) 60%, transparent);
        backdrop-filter: blur(6px);
        border-bottom: 1px solid var(--border);
        margin-bottom: 24px;
      }
      header .container { padding: 16px 20px; }
      h1 {
        margin: 0;
        font-size: 28px;
        letter-spacing: 0.2px;
      }
      h2 {
        margin: 28px 0 12px;
        font-size: 20px;
        color: var(--accent);
      }
      h3 {
        margin: 22px 0 10px;
        font-size: 16px;
        color: var(--accent-2);
      }
      p { margin: 0 0 12px; color: var(--text); }
      .muted { color: var(--muted); }
      ul { margin: 8px 0 16px 20px; padding: 0; }
      li { margin: 6px 0; }
      .panel {
        background: linear-gradient(180deg, rgba(255,255,255,0.02), transparent 40%), var(--panel);
        border: 1px solid var(--border);
        border-radius: 12px;
        padding: 18px 18px;
        margin: 14px 0;
      }
      .grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
        gap: 14px;
      }
      .kbd {
        font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
        background: var(--code-bg);
        border: 1px solid var(--border);
        padding: 0 6px;
        border-radius: 6px;
        color: var(--text);
      }
      .callout {
        border-left: 3px solid var(--accent);
        padding-left: 12px;
      }
      .summary-list li { margin: 4px 0; }
      code { font-family: ui-monospace, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }
      a { color: var(--accent); text-decoration: none; }
      a:hover { text-decoration: underline; }
    </style>
  </head>
  <body>
    <header>
      <div class="container">
        <h1>DOM API l√† g√¨?</h1>
        <p class="muted">T√≥m t·∫Øt kh√°i ni·ªám, ƒë·ªëi t∆∞·ª£ng ch√≠nh, ph∆∞∆°ng th·ª©c truy v·∫•n v√† hi·ªáu nƒÉng</p>
      </div>
    </header>

    <main class="container">
      <section class="panel">
        <p><strong>DOM API</strong>: t·∫≠p h·ª£p c√°c method ƒë·ªÉ thao t√°c tr·ª±c ti·∫øp v·ªõi DOM.</p>
        <p class="muted">Th∆∞·ªùng kh√¥ng d√πng tr·ª±c ti·∫øp v√¨ framework/library (React, Vue, Angular) lo ph·∫ßn n√†y, nh∆∞ng c·∫ßn thi·∫øt khi:</p>
        <ul>
          <li>Vi·∫øt th∆∞ vi·ªán low-level (virtualization, DOM management).</li>
          <li>X√¢y d·ª±ng component generic (video player, chart engine).</li>
          <li>Mu·ªën t·ªëi ∆∞u bundle size (portfolio, lightweight app).</li>
        </ul>
      </section>

      <section>
        <h2>C√°c ƒë·ªëi t∆∞·ª£ng ch√≠nh</h2>
        <div class="grid">
          <div class="panel">
            <h3>Window</h3>
            <p>Global object, ƒë·∫°i di·ªán viewport, ch·ª©a <code>document</code>.</p>
          </div>
          <div class="panel">
            <h3>Document</h3>
            <p>ƒê·∫°i di·ªán to√†n b·ªô HTML, truy c·∫≠p qua <code>window.document</code>.</p>
            <p class="muted">C√≥ quick access: <code>document.body</code>, <code>document.head</code>.</p>
          </div>
          <div class="panel">
            <h3>HTMLElement</h3>
            <p>ƒê·∫°i di·ªán ph·∫ßn t·ª≠ HTML.</p>
            <p class="muted"><code>Element</code> prototype l√† n∆°i ch·ª©a DOM API (√°p d·ª•ng cho HTML/SVG/XML).</p>
          </div>
          <div class="panel">
            <h3>Node</h3>
            <p>ƒê·∫°i di·ªán node trong DOM tree (bao g·ªìm <code>Element</code>, <code>Text</code>...).</p>
          </div>
          <div class="panel">
            <h3>TextNode</h3>
            <p>ƒê·∫°i di·ªán cho text trong DOM.</p>
          </div>
          <div class="panel">
            <h3>HTMLDocument</h3>
            <p>Extends <code>Node</code>, c√≥ DOM API, l√† ngo·∫°i l·ªá nho nh·ªè trong h·ªá th·ªëng class.</p>
          </div>
        </div>
      </section>

      <section>
        <h2>Query Methods (truy v·∫•n DOM)</h2>
        <div class="panel">
          <h3>getElementById</h3>
          <ul>
            <li>D√πng Hashmap ‚Üí <span class="kbd">O(1)</span>.</li>
            <li>Nhanh nh·∫•t, nh∆∞ng ID global ‚Üí c·∫©n th·∫≠n tr√πng ID.</li>
          </ul>
        </div>
        <div class="panel">
          <h3>getElementsByClassName / getElementsByTagName</h3>
          <ul>
            <li>Duy·ªát DFS to√†n b·ªô tree ‚Üí <span class="kbd">O(N)</span>.</li>
            <li>Tr·∫£ v·ªÅ <strong>HTMLCollection (live)</strong>:
              <ul>
                <li>Lu√¥n ph·∫£n √°nh DOM th·∫≠t.</li>
                <li>Read cost <span class="kbd">O(N)</span> (m·ªói l·∫ßn ƒë·ªçc l·∫°i traverse).</li>
                <li><strong>∆Øu</strong>: t·ªën √≠t b·ªô nh·ªõ (ch·ªâ tham chi·∫øu).</li>
                <li><strong>Nh∆∞·ª£c</strong>: ƒë·ªçc/loop nhi·ªÅu s·∫Ω r·∫•t ch·∫≠m (c√≥ th·ªÉ th√†nh <span class="kbd">O(N¬≤)</span>).</li>
              </ul>
            </li>
          </ul>
        </div>
        <div class="panel">
          <h3>querySelector / querySelectorAll</h3>
          <ul>
            <li>S·ª≠ d·ª•ng CSS selector ‚Üí compile selector tr∆∞·ªõc.</li>
            <li>Th∆∞·ªùng <span class="kbd">O(1)</span> cho ƒë·ªçc element (ƒë·∫∑c bi·ªát khi d√πng ID).</li>
            <li><code>querySelector</code> ‚Üí tr·∫£ v·ªÅ ph·∫ßn t·ª≠ ƒë·∫ßu ti√™n.</li>
            <li><code>querySelectorAll</code> ‚Üí tr·∫£ v·ªÅ <strong>NodeList (non-live, copy)</strong>:
              <ul>
                <li>Kh√¥ng c·∫≠p nh·∫≠t khi DOM thay ƒë·ªïi.</li>
                <li>T·ªën th√™m b·ªô nh·ªõ (copy object).</li>
                <li>Truy c·∫≠p nhanh h∆°n (<span class="kbd">O(1)</span>), kh√¥ng c·∫ßn traverse l·∫°i.</li>
              </ul>
            </li>
          </ul>
        </div>
      </section>

      <section>
        <h2>T·ªïng k·∫øt hi·ªáu nƒÉng</h2>
        <div class="panel">
          <ul class="summary-list">
            <li><strong>getElementById</strong>: nhanh nh·∫•t, <span class="kbd">O(1)</span>.</li>
            <li><strong>getElementsByClassName / TagName</strong>: ti·∫øt ki·ªám b·ªô nh·ªõ nh∆∞ng ƒë·ªçc ch·∫≠m, kh√¥ng n√™n loop nhi·ªÅu.</li>
            <li><strong>querySelector / querySelectorAll</strong>: linh ho·∫°t, hi·ªáu nƒÉng g·∫ßn <code>getElementById</code>, nh∆∞ng <code>querySelectorAll</code> t·ªën th√™m memory do copy.</li>
          </ul>
          <p class="muted callout">C∆° ch·∫ø cache & t·ªëi ∆∞u kh√°c nhau gi·ªØa c√°c browser (Safari vs Chrome), kh√¥ng th·ªÉ ƒë·∫£m b·∫£o gi·ªëng nhau.</p>
        </div>

        <div class="panel">
          <h3>üëâ T√≥m g·ªçn:</h3>
          <ul>
            <li><strong>Mu·ªën nhanh</strong> ‚Üí <code>getElementById</code>.</li>
            <li><strong>Mu·ªën √≠t memory</strong> ‚Üí <code>getElementsByClassName</code>/<code>TagName</code> (c·∫©n th·∫≠n <em>live</em>).</li>
            <li><strong>Mu·ªën ti·ªán & linh ho·∫°t</strong> ‚Üí <code>querySelector</code> / <code>querySelectorAll</code>.</li>
          </ul>
        </div>
      </section>

      <section class="muted" style="margin-top:24px">
        <p>G·ª£i √Ω: khi benchmark, h√£y ƒëo theo use-case th·∫≠t c·ªßa b·∫°n, k·∫øt qu·∫£ c√≥ th·ªÉ kh√°c nhau t√πy c·∫•u tr√∫c DOM, k√≠ch th∆∞·ªõc tree, v√† engine tr√¨nh duy·ªát.</p>
      </section>
    </main>
    
    <main class="container" style="padding-top:0">
      <section>
        <h2>V√≠ d·ª• minh ho·∫°</h2>
        <div class="panel">
          <p class="muted" style="margin-bottom:12px">T∆∞∆°ng t√°c d∆∞·ªõi ƒë√¢y minh ho·∫° kh√°c bi·ªát gi·ªØa <strong>HTMLCollection (live)</strong> v√† <strong>NodeList (non-live)</strong>, ƒë·ªìng th·ªùi cho th·∫•y c√°ch d√πng c√°c query methods.</p>
          <div id="demo-box" class="panel" style="margin-top:10px">
            <h3 style="margin-top:0">Demo List</h3>
            <div style="display:flex; gap:8px; flex-wrap:wrap; margin-bottom:10px">
              <button id="btnById">getElementById(‚Äúdemo-box‚Äù)</button>
              <button id="btnByClass">getElementsByClassName(‚Äú.item‚Äù)</button>
              <button id="btnQS">querySelector(‚Äú.item‚Äù)</button>
              <button id="btnQSA">querySelectorAll(‚Äú.item‚Äù)</button>
            </div>
            <div style="display:flex; gap:8px; flex-wrap:wrap; align-items:center; margin-bottom:10px">
              <button id="btnAdd">Th√™m item</button>
              <button id="btnRemove">Xo√° item cu·ªëi</button>
              <span class="muted">HTMLCollection (live): <span id="liveCount" class="kbd">0</span></span>
              <span class="muted">NodeList (snapshot): <span id="snapCount" class="kbd">0</span></span>
            </div>
            <ul id="demoList" class="list">
              <li class="item">Item 1</li>
              <li class="item">Item 2</li>
              <li class="item">Item 3</li>
            </ul>
            <div id="log" class="muted" style="margin-top:8px"></div>
          </div>
        </div>
      </section>
    </main>
    
    <script>
      (function() {
        const demoBox = document.getElementById('demo-box');
        const demoList = document.getElementById('demoList');
        const log = document.getElementById('log');
        const liveCountEl = document.getElementById('liveCount');
        const snapCountEl = document.getElementById('snapCount');

        // Live HTMLCollection (updates automatically when DOM changes)
        const liveCollection = document.getElementsByClassName('item');
        // Snapshot NodeList (will not update unless queried again)
        let snapshotList = document.querySelectorAll('.item');

        function updateCounters() {
          liveCountEl.textContent = String(liveCollection.length);
          snapCountEl.textContent = String(snapshotList.length);
        }

        function highlight(el) {
          if (!el) return;
          const original = el.style.boxShadow;
          el.style.boxShadow = '0 0 0 2px rgba(103,232,249,0.9) inset, 0 0 0 2px rgba(103,232,249,0.2)';
          setTimeout(() => { el.style.boxShadow = original; }, 600);
        }

        function logLine(text) {
          const time = new Date().toLocaleTimeString();
          log.textContent = `[${time}] ${text}`;
        }

        document.getElementById('btnById').addEventListener('click', () => {
          const el = document.getElementById('demo-box');
          highlight(el);
          logLine('getElementById("demo-box") ‚Üí 1 element');
        });

        document.getElementById('btnByClass').addEventListener('click', () => {
          // Accessing liveCollection reflects current DOM without re-query
          const count = liveCollection.length;
          if (count > 0) highlight(liveCollection[0]);
          logLine(`getElementsByClassName('.item') ‚Üí HTMLCollection (live), length=${count}`);
          updateCounters();
        });

        document.getElementById('btnQS').addEventListener('click', () => {
          const first = document.querySelector('.item');
          highlight(first);
          logLine('querySelector(".item") ‚Üí ph·∫ßn t·ª≠ ƒë·∫ßu ti√™n');
        });

        document.getElementById('btnQSA').addEventListener('click', () => {
          snapshotList = document.querySelectorAll('.item');
          if (snapshotList.length > 0) highlight(snapshotList[0]);
          logLine(`querySelectorAll('.item') ‚Üí NodeList (snapshot), length=${snapshotList.length}`);
          updateCounters();
        });

        let nextIndex = 4;
        document.getElementById('btnAdd').addEventListener('click', () => {
          const li = document.createElement('li');
          li.className = 'item';
          li.textContent = `Item ${nextIndex++}`;
          demoList.appendChild(li);
          // liveCollection updates automatically; snapshot stays the same until re-query
          updateCounters();
          logLine('Th√™m item ‚Üí HTMLCollection tƒÉng ngay; NodeList gi·ªØ nguy√™n cho ƒë·∫øn khi query l·∫°i');
        });

        document.getElementById('btnRemove').addEventListener('click', () => {
          const last = demoList.lastElementChild;
          if (!last) return;
          demoList.removeChild(last);
          updateCounters();
          logLine('Xo√° item ‚Üí HTMLCollection gi·∫£m ngay; NodeList gi·ªØ nguy√™n cho ƒë·∫øn khi query l·∫°i');
        });

        // Initial counters
        updateCounters();
      })();
    </script>
  </body>
  </html>


