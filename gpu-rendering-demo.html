<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GPU Rendering Demo - Browser Rendering Pipeline</title>
    <link rel="stylesheet" href="gpu-rendering-styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>üöÄ GPU Rendering trong Browser</h1>
            <p class="subtitle">T√¨m hi·ªÉu c√°ch Browser s·ª≠ d·ª•ng GPU ƒë·ªÉ t·ªëi ∆∞u h√≥a rendering</p>
        </header>

        <!-- CPU vs GPU Section -->
        <section class="demo-section">
            <h2>1. CPU vs GPU Rendering</h2>
            <div class="comparison-container">
                <div class="comparison-item old-browser">
                    <h3>Tr√¨nh duy·ªát c≈© (CPU only)</h3>
                    <div class="performance-meter">
                        <div class="meter-bar cpu-heavy"></div>
                        <span class="meter-label">Ch·∫≠m - Ch·ªâ d√πng CPU</span>
                    </div>
                    <div class="demo-box cpu-demo">
                        <div class="animated-element cpu-animation">CPU Animation</div>
                    </div>
                </div>
                <div class="comparison-item new-browser">
                    <h3>Tr√¨nh duy·ªát m·ªõi (CPU + GPU)</h3>
                    <div class="performance-meter">
                        <div class="meter-bar gpu-optimized"></div>
                        <span class="meter-label">Nhanh - CPU + GPU song song</span>
                    </div>
                    <div class="demo-box gpu-demo">
                        <div class="animated-element gpu-animation">GPU Animation</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Render Tree & Render Object Section -->
        <section class="demo-section">
            <h2>2. Render Tree & Render Object</h2>
            <div class="tree-demo">
                <div class="tree-container">
                    <div class="dom-tree">
                        <h3>DOM Tree</h3>
                        <div class="tree-node root">html
                            <div class="tree-node">head
                                <div class="tree-node">title</div>
                            </div>
                            <div class="tree-node">body
                                <div class="tree-node">div.container
                                    <div class="tree-node">h1</div>
                                    <div class="tree-node">p</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="arrow">‚Üí</div>
                    <div class="render-tree">
                        <h3>Render Tree</h3>
                        <div class="render-objects">
                            <div class="render-object">RenderObject(html)</div>
                            <div class="render-object">RenderObject(body)</div>
                            <div class="render-object">RenderObject(div.container)</div>
                            <div class="render-object">RenderObject(h1)</div>
                            <div class="render-object">RenderObject(p)</div>
                        </div>
                    </div>
                </div>
                <div class="explanation">
                    <p><strong>DOM:</strong> L∆∞u th√¥ng tin HTML structure</p>
                    <p><strong>Render Object:</strong> Bi·∫øt c√°ch v·∫Ω l√™n bitmap</p>
                </div>
            </div>
        </section>

        <!-- Render Layer Section -->
        <section class="demo-section">
            <h2>3. Render Layer Creation</h2>
            <div class="layer-demo">
                <h3>Render Layer ƒë∆∞·ª£c t·∫°o khi:</h3>
                <div class="layer-conditions">
                    <div class="condition-item">
                        <h4>Root element</h4>
                        <div class="demo-element root-layer">Root Layer</div>
                    </div>
                    <div class="condition-item">
                        <h4>position: relative/absolute</h4>
                        <div class="demo-element relative-layer">Relative Layer</div>
                        <div class="demo-element absolute-layer">Absolute Layer</div>
                    </div>
                    <div class="condition-item">
                        <h4>Canvas, CSS filters</h4>
                        <canvas class="demo-element canvas-layer" width="100" height="50"></canvas>
                        <div class="demo-element filter-layer">Filter Layer</div>
                    </div>
                </div>
                <div class="layer-stack">
                    <h4>Layer Stack (Stacking Context)</h4>
                    <div class="stack-visualization">
                        <div class="stack-layer" style="z-index: 3">Layer 3 (z-index: 3)</div>
                        <div class="stack-layer" style="z-index: 2">Layer 2 (z-index: 2)</div>
                        <div class="stack-layer" style="z-index: 1">Layer 1 (z-index: 1)</div>
                        <div class="stack-layer" style="z-index: 0">Root Layer (z-index: 0)</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Graphic Layer Section -->
        <section class="demo-section">
            <h2>4. Graphic Layer (GPU Layer)</h2>
            <div class="graphic-layer-demo">
                <h3>Graphic Layer ƒë∆∞·ª£c t·∫°o khi c√≥:</h3>
                <div class="gpu-conditions">
                    <div class="condition-item">
                        <h4>3D Transform</h4>
                        <div class="demo-element transform-3d">3D Transform</div>
                    </div>
                    <div class="condition-item">
                        <h4>Video Element</h4>
                        <video class="demo-element video-layer" width="100" height="50" muted>
                            <source src="data:video/mp4;base64," type="video/mp4">
                        </video>
                    </div>
                    <div class="condition-item">
                        <h4>GPU Decoding</h4>
                        <div class="demo-element gpu-decode">GPU Decode</div>
                    </div>
                </div>
                
                <div class="vram-cost">
                    <h3>Chi ph√≠ VRAM</h3>
                    <div class="cost-calculator">
                        <div class="cost-item">
                            <span>Root Graphic Layer:</span>
                            <span class="cost">~8.7MB</span>
                        </div>
                        <div class="cost-item">
                            <span>M·ªói layer th√™m:</span>
                            <span class="cost">~0.5MB</span>
                        </div>
                        <div class="cost-item total">
                            <span>100 layers:</span>
                            <span class="cost">~58.7MB VRAM</span>
                        </div>
                    </div>
                    <div class="vram-warning">
                        ‚ö†Ô∏è Tr√™n mobile (√≠t VRAM) ‚Üí d·ªÖ g√¢y lag
                    </div>
                </div>
            </div>
        </section>

        <!-- Performance Comparison Section -->
        <section class="demo-section">
            <h2>5. So s√°nh Hi·ªáu su·∫•t</h2>
            <div class="performance-demo">
                <div class="performance-test">
                    <h3>CPU Heavy (Reflow/Layout)</h3>
                    <button id="reflow-test" class="test-button">Test Reflow</button>
                    <div class="test-container">
                        <div class="test-element reflow-element">Resize me</div>
                    </div>
                    <div class="performance-indicator">
                        <span class="fps-counter">FPS: <span id="reflow-fps">60</span></span>
                        <div class="frame-drops">Frame drops: <span id="reflow-drops">0</span></div>
                    </div>
                </div>
                
                <div class="performance-test">
                    <h3>GPU Optimized (Transform/Opacity)</h3>
                    <button id="gpu-test" class="test-button">Test GPU</button>
                    <div class="test-container">
                        <div class="test-element gpu-element">Transform me</div>
                    </div>
                    <div class="performance-indicator">
                        <span class="fps-counter">FPS: <span id="gpu-fps">60</span></span>
                        <div class="frame-drops">Frame drops: <span id="gpu-drops">0</span></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- CSS Triggers Demo -->
        <section class="demo-section">
            <h2>6. CSS Properties Impact</h2>
            <div class="css-triggers-demo">
                <div class="property-category bad">
                    <h3>‚ùå G√¢y Reflow (CPU Heavy)</h3>
                    <div class="property-list">
                        <button class="property-btn" data-property="width">width</button>
                        <button class="property-btn" data-property="height">height</button>
                        <button class="property-btn" data-property="margin">margin</button>
                        <button class="property-btn" data-property="padding">padding</button>
                        <button class="property-btn" data-property="left">left</button>
                        <button class="property-btn" data-property="top">top</button>
                    </div>
                </div>
                
                <div class="property-category good">
                    <h3>‚úÖ GPU Friendly</h3>
                    <div class="property-list">
                        <button class="property-btn" data-property="transform">transform</button>
                        <button class="property-btn" data-property="opacity">opacity</button>
                        <button class="property-btn" data-property="filter">filter</button>
                        <button class="property-btn" data-property="backdrop-filter">backdrop-filter</button>
                    </div>
                </div>
                
                <div class="demo-element" id="css-test-element">Test Element</div>
            </div>
        </section>

        <!-- Rule of Thumb Section -->
        <section class="demo-section">
            <h2>7. Rule of Thumb</h2>
            <div class="rules-container">
                <div class="rule-item">
                    <h3>üéØ ∆Øu ti√™n GPU</h3>
                    <ul>
                        <li>transform: translateX(), scale(), rotate()</li>
                        <li>opacity: 0 ‚Üí 1</li>
                        <li>filter: blur(), brightness()</li>
                    </ul>
                </div>
                <div class="rule-item">
                    <h3>‚ö†Ô∏è Tr√°nh Reflow</h3>
                    <ul>
                        <li>Thay ƒë·ªïi width, height</li>
                        <li>Thay ƒë·ªïi margin, padding</li>
                        <li>Thay ƒë·ªïi position (static ‚Üí relative)</li>
                    </ul>
                </div>
                <div class="rule-item">
                    <h3>üìä Ki·ªÉm tra Performance</h3>
                    <ul>
                        <li>S·ª≠ d·ª•ng DevTools Performance tab</li>
                        <li>Ki·ªÉm tra csstriggers.com</li>
                        <li>Monitor FPS v√† frame drops</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Summary -->
        <section class="demo-section summary">
            <h2>üìù T√≥m t·∫Øt</h2>
            <div class="summary-content">
                <div class="summary-item">
                    <h3>Pipeline</h3>
                    <p>DOM ‚Üí Render Object ‚Üí Render Layer ‚Üí Graphic Layer</p>
                </div>
                <div class="summary-item">
                    <h3>Nguy√™n t·∫Øc</h3>
                    <p>Tr√°nh reflow, ∆∞u ti√™n GPU-friendly properties</p>
                </div>
                <div class="summary-item">
                    <h3>C√¢n nh·∫Øc</h3>
                    <p>Graphic Layer gi√∫p animation m∆∞·ª£t nh∆∞ng t·ªën VRAM</p>
                </div>
            </div>
        </section>
    </div>

    <script src="gpu-rendering-script.js"></script>
</body>
</html>
